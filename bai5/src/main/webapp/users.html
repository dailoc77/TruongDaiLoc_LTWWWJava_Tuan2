<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Management</title>
    <style>
        table, th, td { border: 1px solid black; border-collapse: collapse; }
        th, td { padding: 8px; }
        form { margin-bottom: 16px; }
    </style>
</head>
<body>
<h2>User Management</h2>

<form id="userForm">
    <input type="hidden" id="userId">
    <label>First Name: <input type="text" id="firstName" required></label>
    <label>Last Name: <input type="text" id="lastName" required></label>
    <label>DOB: <input type="date" id="dob" required></label>
    <button type="submit">Save</button>
    <button type="button" onclick="resetForm()">Clear</button>
</form>

<table id="usersTable">
    <thead>
    <tr>
        <th>ID</th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>DOB</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
const apiUrl = '/api/users';

function fetchUsers() {
    fetch(apiUrl)
        .then(res => res.json())
        .then(users => {
            const tbody = document.querySelector('#usersTable tbody');
            tbody.innerHTML = '';
            users.forEach(user => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.firstName}</td>
                    <td>${user.lastName}</td>
                    <td>${user.dob ? user.dob.substring(0,10) : ''}</td>
                    <td>
                        <button onclick="editUser(${user.id})">Edit</button>
                        <button onclick="deleteUser(${user.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        });
}

function resetForm() {
    document.getElementById('userId').value = '';
    document.getElementById('firstName').value = '';
    document.getElementById('lastName').value = '';
    document.getElementById('dob').value = '';
}

document.getElementById('userForm').onsubmit = function(e) {
    e.preventDefault();
    const id = document.getElementById('userId').value;
    const user = {
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        dob: document.getElementById('dob').value
    };
    if (id) {
        fetch(apiUrl + '/' + id, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(user)
        }).then(fetchUsers);
    } else {
        fetch(apiUrl, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(user)
        }).then(fetchUsers);
    }
    resetForm();
};

function editUser(id) {
    fetch(apiUrl + '/' + id)
        .then(res => res.json())
        .then(user => {
            document.getElementById('userId').value = user.id;
            document.getElementById('firstName').value = user.firstName;
            document.getElementById('lastName').value = user.lastName;
            document.getElementById('dob').value = user.dob ? user.dob.substring(0,10) : '';
        });
}

function deleteUser(id) {
    if (confirm('Delete user?')) {
        fetch(apiUrl + '/' + id, { method: 'DELETE' })
            .then(fetchUsers);
    }
}

fetchUsers();
</script>
</body>
</html>

